<!DOCTYPE html>
<html lang="en" dir="ltr" class="client-nojs">
<head>
<title>HPN-SSH on RHEL6 - Kyle's Wiki</title>
<meta charset="UTF-8" />
<meta name="generator" content="MediaWiki 1.19.1" />
<link rel="shortcut icon" href="/favicon.ico.html" />
<link rel="search" type="application/opensearchdescription+xml" href="/opensearch_desc.php.html" title="Kyle's Wiki (en)" />
<link rel="EditURI" type="application/rsd+xml" href="http://wiki.xkyle.com/api.php?action=rsd" />
<link rel="copyright" href="http://creativecommons.org/licenses/by-sa/3.0/" />
<link rel="alternate" type="application/atom+xml" title="Kyle's Wiki Atom feed" href="/index.php?title=Special:RecentChanges&amp;feed=atom" />
<link rel="stylesheet" href="http://wiki.xkyle.com/load.php?debug=false&amp;lang=en&amp;modules=mediawiki.legacy.commonPrint%2Cshared%7Cskins.vector&amp;only=styles&amp;skin=vector&amp;*" />
<meta name="ResourceLoaderDynamicStyles" content="" />
<style>a:lang(ar),a:lang(ckb),a:lang(fa),a:lang(kk-arab),a:lang(mzn),a:lang(ps),a:lang(ur){text-decoration:none}a.new,#quickbar a.new{color:#ba0000}

/* cache key: my_wiki:resourceloader:filter:minify-css:7:c88e2bcd56513749bec09a7e29cb3ffa */
</style>

<script src="http://wiki.xkyle.com/load.php?debug=false&amp;lang=en&amp;modules=startup&amp;only=scripts&amp;skin=vector&amp;*"></script>
<script>if(window.mw){
mw.config.set({"wgCanonicalNamespace":"","wgCanonicalSpecialPageName":false,"wgNamespaceNumber":0,"wgPageName":"HPN-SSH_on_RHEL6","wgTitle":"HPN-SSH on RHEL6","wgCurRevisionId":1672,"wgArticleId":485,"wgIsArticle":true,"wgAction":"view","wgUserName":null,"wgUserGroups":["*"],"wgCategories":["SSH","RHEL6","HPC"],"wgBreakFrames":false,"wgPageContentLanguage":"en","wgSeparatorTransformTable":["",""],"wgDigitTransformTable":["",""],"wgRelevantPageName":"HPN-SSH_on_RHEL6","wgRestrictionEdit":[],"wgRestrictionMove":[]});
}</script><script>if(window.mw){
mw.loader.implement("user.options",function($){mw.user.options.set({"ccmeonemails":0,"cols":80,"date":"default","diffonly":0,"disablemail":0,"disablesuggest":0,"editfont":"default","editondblclick":0,"editsection":1,"editsectiononrightclick":0,"enotifminoredits":0,"enotifrevealaddr":0,"enotifusertalkpages":1,"enotifwatchlistpages":0,"extendwatchlist":0,"externaldiff":0,"externaleditor":0,"fancysig":0,"forceeditsummary":0,"gender":"unknown","hideminor":0,"hidepatrolled":0,"highlightbroken":1,"imagesize":2,"justify":0,"math":1,"minordefault":0,"newpageshidepatrolled":0,"nocache":0,"noconvertlink":0,"norollbackdiff":0,"numberheadings":0,"previewonfirst":0,"previewontop":1,"quickbar":5,"rcdays":7,"rclimit":50,"rememberpassword":0,"rows":25,"searchlimit":20,"showhiddencats":0,"showjumplinks":1,"shownumberswatching":1,"showtoc":1,"showtoolbar":1,"skin":"vector","stubthreshold":0,"thumbsize":2,"underline":2,"uselivepreview":0,"usenewrc":0,"watchcreations":0,"watchdefault":0,"watchdeletion":0,
"watchlistdays":3,"watchlisthideanons":0,"watchlisthidebots":0,"watchlisthideliu":0,"watchlisthideminor":0,"watchlisthideown":0,"watchlisthidepatrolled":0,"watchmoves":0,"wllimit":250,"variant":"en","language":"en","searchNs0":true,"searchNs1":false,"searchNs2":false,"searchNs3":false,"searchNs4":false,"searchNs5":false,"searchNs6":false,"searchNs7":false,"searchNs8":false,"searchNs9":false,"searchNs10":false,"searchNs11":false,"searchNs12":false,"searchNs13":false,"searchNs14":false,"searchNs15":false});;},{},{});mw.loader.implement("user.tokens",function($){mw.user.tokens.set({"editToken":"+\\","watchToken":false});;},{},{});

/* cache key: my_wiki:resourceloader:filter:minify-js:7:9983699ab6150ffa89a90653b2338ac8 */
}</script>
<script>if(window.mw){
mw.loader.load(["mediawiki.page.startup","mediawiki.legacy.wikibits","mediawiki.legacy.ajax"]);
}</script>
<!--[if lt IE 7]><style type="text/css">body{behavior:url("/skins/vector/csshover.min.htc")}</style><![endif]--><!-- start Mixpanel --><script type="text/javascript">(function(e,b){if(!b.__SV){var a,f,i,g;window.mixpanel=b;a=e.createElement("script");a.type="text/javascript";a.async=!0;a.src=("https:"===e.location.protocol?"https:":"http:")+'//cdn.mxpnl.com/libs/mixpanel-2.2.min.js';f=e.getElementsByTagName("script")[0];f.parentNode.insertBefore(a,f);b._i=[];b.init=function(a,e,d){function f(b,h){var a=h.split(".");2==a.length&&(b=b[a[0]],h=a[1]);b[h]=function(){b.push([h].concat(Array.prototype.slice.call(arguments,0)))}}var c=b;"undefined"!==
typeof d?c=b[d]=[]:d="mixpanel";c.people=c.people||[];c.toString=function(b){var a="mixpanel";"mixpanel"!==d&&(a+="."+d);b||(a+=" (stub)");return a};c.people.toString=function(){return c.toString(1)+".people (stub)"};i="disable track track_pageview track_links track_forms register register_once alias unregister identify name_tag set_config people.set people.set_once people.increment people.append people.track_charge people.clear_charges people.delete_user".split(" ");for(g=0;g<i.length;g++)f(c,i[g]);
b._i.push([a,e,d])};b.__SV=1.2}})(document,window.mixpanel||[]);
mixpanel.init("f49fd1e08211929444aad692b8995519");mixpanel.track('pageload')</script><!-- end Mixpanel --></head>
<body class="mediawiki ltr sitedir-ltr ns-0 ns-subject page-HPN-SSH_on_RHEL6 skin-vector action-view">
		<div id="mw-page-base" class="noprint"></div>
		<div id="mw-head-base" class="noprint"></div>
		<!-- content -->
		<div id="content" class="mw-body">
			<a id="top"></a>
			<div id="mw-js-message" style="display:none;"></div>
						<!-- firstHeading -->
			<h1 id="firstHeading" class="firstHeading">
				<span dir="auto">HPN-SSH on RHEL6</span>
			</h1>
			<!-- /firstHeading -->
			<!-- bodyContent -->
			<div id="bodyContent">
								<!-- tagline -->
				<div id="siteSub">From Kyle&#039;s Wiki</div>
				<!-- /tagline -->
								<!-- subtitle -->
				<div id="contentSub"></div>
				<!-- /subtitle -->
																<!-- jumpto -->
				<div id="jump-to-nav" class="mw-jump">
					Jump to: <a href="#mw-head">navigation</a>,
					<a href="#p-search">search</a>
				</div>
				<!-- /jumpto -->
								<!-- bodycontent -->
				<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr"><p>Spec file:
</p>
<pre>
# Do we want SELinux &amp; Audit
%define WITH_SELINUX 1

# OpenSSH privilege separation requires a user &amp; group ID
%define sshd_uid    74
%define sshd_gid    74

# Do we want to disable building of gnome-askpass? (1=yes 0=no)
%define no_gnome_askpass 0

# Do we want to link against a static libcrypto? (1=yes 0=no)
%define static_libcrypto 0

# Do we want smartcard support (1=yes 0=no)
%define scard 0

# Use GTK2 instead of GNOME in gnome-ssh-askpass
%define gtk2 1

# Build position-independent executables (requires toolchain support)?
%define pie 1

# Do we want kerberos5 support (1=yes 0=no)
%define kerberos5 1

# Do we want LDAP support
%define ldap 1

# Do we want libedit support
%define libedit 1

# Do we want NSS tokens support
%define nss 1

# Whether or not /sbin/nologin exists.
%define nologin 1

# Whether to build pam_ssh_agent_auth
%define pam_ssh_agent 1

# Reserve options to override askpass settings with:
# rpm -ba|--rebuild --define 'skip_xxx 1'
%{?skip_gnome_askpass:%define no_gnome_askpass 1}

# Add option to build without GTK2 for older platforms with only GTK+.
# Red Hat Linux &lt;= 7.2 and Red Hat Advanced Server 2.1 are examples.
# rpm -ba|--rebuild --define 'no_gtk2 1'
%{?no_gtk2:%define gtk2 0}

# Options for static OpenSSL link:
# rpm -ba|--rebuild --define &quot;static_openssl 1&quot;
%{?static_openssl:%define static_libcrypto 1}

# Options for Smartcard support: (needs libsectok and openssl-engine)
# rpm -ba|--rebuild --define &quot;smartcard 1&quot;
%{?smartcard:%define scard 1}

# Is this a build for the rescue CD (without PAM, with MD5)? (1=yes 0=no)
%define rescue 0
%{?build_rescue:%define rescue 1}
%{?build_rescue:%define rescue_rel rescue}

# Turn off some stuff for resuce builds
%if&#160;%{rescue}
%define kerberos5 0
%define libedit 0
%define pam_ssh_agent 0
%endif

%define pam_ssh_agent_ver 0.9

Summary: An open source implementation of SSH protocol versions 1 and 2
Name: openssh
Version: 5.3p1
Release: 52%{?dist}.2%{?rescue_rel}
URL: http://www.openssh.com/portable.html
#URL1: http://pamsshauth.sourceforge.net
#Source0: ftp://ftp.openbsd.org/pub/OpenBSD/OpenSSH/portable/openssh-%{version}.tar.gz
#Source1: ftp://ftp.openbsd.org/pub/OpenBSD/OpenSSH/portable/openssh-%{version}.tar.gz.asc
# This package differs from the upstream OpenSSH tarball in that
# the ACSS cipher is removed by running openssh-nukeacss.sh in
# the unpacked source directory.
Source0: openssh-%{version}-noacss.tar.bz2
Source1: openssh-nukeacss.sh
Source2: sshd.pam
Source3: sshd.init
Source4: http://prdownloads.sourceforge.net/pamsshagentauth/pam_ssh_agent_auth/pam_ssh_agent_auth-%{pam_ssh_agent_ver}.tar.bz2
Source5: pam_ssh_agent-rmheaders
Source6: ssh-keycat.pam
Source7: sshd.sysconfig
Patch0: openssh-5.2p1-redhat.patch
Patch1: openssh5.3-dynwindow_noneswitch.diff
Patch2: openssh-5.3p1-skip-initial.patch
Patch3: openssh-5.3-CTR-threading.diff
Patch4: openssh-5.2p1-vendor.patch
Patch5: openssh-5.3p1-engine.patch
Patch10: pam_ssh_agent_auth-0.9-build.patch
Patch11: pam_ssh_agent_auth-0.9.2-seteuid.patch
Patch12: openssh-5.2p1-selinux.patch
Patch13: openssh-5.3p1-mls.patch
Patch18: openssh-5.0p1-pam_selinux.patch
Patch19: openssh-5.2p1-sesftp.patch
Patch22: openssh-3.9p1-askpass-keep-above.patch
Patch24: openssh-4.3p1-fromto-remote.patch
Patch27: openssh-5.1p1-log-in-chroot.patch
Patch30: openssh-4.0p1-exit-deadlock.patch
Patch35: openssh-5.1p1-askpass-progress.patch
Patch38: openssh-4.3p2-askpass-grab-info.patch
Patch39: openssh-4.3p2-no-v6only.patch
Patch44: openssh-5.2p1-allow-ip-opts.patch
Patch49: openssh-4.3p2-gssapi-canohost.patch
Patch51: openssh-5.3p1-nss-keys.patch
Patch55: openssh-5.1p1-cloexec.patch
Patch62: openssh-5.1p1-scp-manpage.patch
Patch65: openssh-5.3p1-fips.patch
Patch69: openssh-5.3p1-selabel.patch
Patch71: openssh-5.2p1-edns.patch
Patch73: openssh-5.3p1-gsskex.patch
Patch74: openssh-5.3p1-randclean.patch
Patch75: openssh-5.3p1-strictalias.patch
Patch76: openssh-5.3p1-595935.patch
Patch77: openssh-5.3p1-x11.patch
Patch78: openssh-5.3p1-authorized-keys-command.patch
Patch79: openssh-5.3p1-stderr.patch
Patch80: openssh-5.3p1-audit.patch
Patch81: openssh-5.3p1-biguid.patch
Patch82: openssh-5.3p1-kuserok.patch
Patch83: openssh-5.3p1-sftp_umask.patch
Patch84: openssh-5.3p1-clientloop.patch
Patch85: openssh-5.3p1-ldap.patch
Patch86: openssh-5.3p1-keycat.patch
Patch87: openssh-5.3p1-sftp-chroot.patch
Patch88: openssh-5.3p1-entropy.patch
Patch89: openssh-5.3p1-multiple-sighup.patch

License: BSD
Group: Applications/Internet
BuildRoot:&#160;%{_tmppath}/%{name}-%{version}-%{release}-root-%(%{__id_u} -n)
%if&#160;%{nologin}
Requires: /sbin/nologin
%endif

Requires: initscripts &gt;= 5.20

%if&#160;!&#160;%{no_gnome_askpass}
%if&#160;%{gtk2}
BuildRequires: gtk2-devel
BuildRequires: libX11-devel
%else
BuildRequires: gnome-libs-devel
%endif
%endif

%if&#160;%{scard}
BuildRequires: sharutils
%endif
BuildRequires: autoconf, automake, perl, zlib-devel
BuildRequires: audit-libs-devel &gt;= 2.0.5
BuildRequires: util-linux, groff, man
BuildRequires: pam-devel
BuildRequires: tcp_wrappers-devel
BuildRequires: fipscheck-devel
BuildRequires: openssl-devel &gt;= 0.9.8j
%if&#160;%{ldap}
BuildRequires: openldap-devel
%endif

%if&#160;%{kerberos5}
BuildRequires: krb5-devel
%endif

%if&#160;%{libedit}
BuildRequires: libedit-devel ncurses-devel
%endif

%if&#160;%{nss}
BuildRequires: nss-devel
%endif

%if&#160;%{WITH_SELINUX}
Requires: libselinux &gt;= 1.27.7
BuildRequires: libselinux-devel &gt;= 1.27.7
Requires: audit-libs &gt;= 1.0.8
BuildRequires: audit-libs &gt;= 1.0.8
%endif

BuildRequires: xauth

%package clients
Summary: An open source SSH client applications
Requires: openssh =&#160;%{version}-%{release}
Group: Applications/Internet

%package server
Summary: An open source SSH server daemon
Group: System Environment/Daemons
Requires: openssh =&#160;%{version}-%{release}
Requires(post): chkconfig &gt;= 0.9, /sbin/service
Requires(pre): /usr/sbin/useradd
Requires: pam &gt;= 1.0.1-3

%package askpass
Summary: A passphrase dialog for OpenSSH and X
Group: Applications/Internet
Requires: openssh =&#160;%{version}-%{release}
Obsoletes: openssh-askpass-gnome
Provides: openssh-askpass-gnome

%if&#160;%{ldap}
%package ldap
Summary: A LDAP support for open source SSH server daemon
Requires: openssh =&#160;%{version}-%{release}
Group: System Environment/Daemons
%endif

%package -n pam_ssh_agent_auth
Summary: PAM module for authentication with ssh-agent
Group: System Environment/Base
Version:&#160;%{pam_ssh_agent_ver}
# There is special exception added to the GPLv3+ license to
# permit linking with OpenSSL licensed code
License: GPLv3+ and OpenSSL and BSD

%description
SSH (Secure SHell) is a program for logging into and executing
commands on a remote machine. SSH is intended to replace rlogin and
rsh, and to provide secure encrypted communications between two
untrusted hosts over an insecure network. X11 connections and
arbitrary TCP/IP ports can also be forwarded over the secure channel.

OpenSSH is OpenBSD's version of the last free version of SSH, bringing
it up to date in terms of security and features.

This package includes the core files necessary for both the OpenSSH
client and server. To make this package useful, you should also
install openssh-clients, openssh-server, or both.

%description clients
OpenSSH is a free version of SSH (Secure SHell), a program for logging
into and executing commands on a remote machine. This package includes
the clients necessary to make encrypted connections to SSH servers.

%description server
OpenSSH is a free version of SSH (Secure SHell), a program for logging
into and executing commands on a remote machine. This package contains
the secure shell daemon (sshd). The sshd daemon allows SSH clients to
securely connect to your SSH server.

%description askpass
OpenSSH is a free version of SSH (Secure SHell), a program for logging
into and executing commands on a remote machine. This package contains
an X11 passphrase dialog for OpenSSH.

%if&#160;%{ldap}
%description ldap
OpenSSH LDAP backend is a way how to distribute the authorized tokens
among the servers in the network.
%endif

%description -n pam_ssh_agent_auth
This package contains a PAM module which can be used to authenticate
users using ssh keys stored in a ssh-agent. Through the use of the
forwarding of ssh-agent connection it also allows to authenticate with
remote ssh-agent instance.

The module is most useful for su and sudo service stacks.

%prep
%setup -q -a 4
%patch0 -p1 -b .redhat
%patch1 -p1 -b .window
%patch2 -p1 -b .skip-initial
%patch3 -p1 -b .ctr
#%patch4 -p1 -b .vendor
%patch5 -p1 -b .engine

%if&#160;%{pam_ssh_agent}
pushd pam_ssh_agent_auth-%{pam_ssh_agent_ver}
%patch10 -p1 -b .psaa-build
%patch11 -p1 -b .psaa-seteuid
# Remove duplicate headers
rm -f $(cat&#160;%{SOURCE5})
popd
%endif

#%if&#160;%{WITH_SELINUX}
#SELinux
#%patch12 -p1 -b .selinux
#%patch13 -p1 -b .mls
#%patch18 -p1 -b .pam_selinux
#%patch19 -p1 -b .sesftp
#%endif

%patch22 -p1 -b .keep-above
%patch24 -p1 -b .fromto-remote
%patch27 -p1 -b .log-chroot
%patch30 -p1 -b .exit-deadlock
%patch35 -p1 -b .progress
%patch38 -p1 -b .grab-info
%patch39 -p1 -b .no-v6only
%patch44 -p1 -b .ip-opts
%patch49 -p1 -b .canohost
%patch51 -p1 -b .nss-keys
#%patch55 -p1 -b .cloexec
%patch62 -p1 -b .manpage
#%patch65 -p1 -b .fips
#%patch69 -p1 -b .selabel
%patch71 -p1 -b .edns
#%patch73 -p1 -b .gsskex
%patch74 -p1 -b .randclean
%patch75 -p1 -b .strictalias
%patch76 -p1 -b .bz595935
%patch77 -p1 -b .x11
#%patch78 -p1 -b .akc
%patch79 -p1 -b .stderr
#%patch80 -p1 -b .audit
%patch81 -p1 -b .biguid
#%patch82 -p1 -b .kuserok
%patch83 -p1 -b .sftp-umask
%patch84 -p1 -b .clientloop
#%if&#160;%{ldap}
#%patch85 -p1 -b .ldap
#%endif
#%patch86 -p1 -b .keycat
#%patch87 -p1 -b .sftp-chroot
%patch88 -p1 -b .entropy
%patch89 -p1 -b .multiple-sighhup

autoreconf

%build
CFLAGS=&quot;$RPM_OPT_FLAGS&quot;; export CFLAGS
%if&#160;%{rescue}
CFLAGS=&quot;$CFLAGS -Os&quot;
%endif
%if&#160;%{pie}
%ifarch s390 s390x sparc sparcv9 sparc64
CFLAGS=&quot;$CFLAGS -fPIC&quot;
%else
CFLAGS=&quot;$CFLAGS -fpic&quot;
%endif
export CFLAGS
SAVE_LDFLAGS=&quot;$LDFLAGS&quot;
LDFLAGS=&quot;$LDFLAGS -pie&quot;; export LDFLAGS
LDFLAGS=&quot;$LDFLAGS -Wl,-z,relro -Wl,-z,now&quot;; export LDFLAGS
%endif
%if&#160;%{kerberos5}
if test -r /etc/profile.d/krb5-devel.sh&#160;; then
        source /etc/profile.d/krb5-devel.sh
fi
krb5_prefix=`krb5-config --prefix`
if test &quot;$krb5_prefix&quot;&#160;!= &quot;%{_prefix}&quot;&#160;; then
	CPPFLAGS=&quot;$CPPFLAGS -I${krb5_prefix}/include -I${krb5_prefix}/include/gssapi&quot;; export CPPFLAGS
	CFLAGS=&quot;$CFLAGS -I${krb5_prefix}/include -I${krb5_prefix}/include/gssapi&quot;
	LDFLAGS=&quot;$LDFLAGS -L${krb5_prefix}/%{_lib}&quot;; export LDFLAGS
else
	krb5_prefix=
	CPPFLAGS=&quot;-I%{_includedir}/gssapi&quot;; export CPPFLAGS
	CFLAGS=&quot;$CFLAGS -I%{_includedir}/gssapi&quot;
fi
%endif

%configure \
	--sysconfdir=%{_sysconfdir}/ssh \
	--libexecdir=%{_libexecdir}/openssh \
	--datadir=%{_datadir}/openssh \
	--with-tcp-wrappers \
	--with-default-path=/usr/local/bin:/bin:/usr/bin \
	--with-superuser-path=/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin \
	--with-privsep-path=%{_var}/empty/sshd \
	--disable-strip \
	--without-zlib-version-check \
	--with-ssl-engine \
	--with-pam 
#%if&#160;%{ldap}
#	--with-ldap \
#%endif
#%if&#160;%{nss}
#	--with-nss \
#%endif
%if&#160;%{scard}
	--with-smartcard \
%endif
#%if&#160;%{WITH_SELINUX}
#	--with-selinux --with-audit=linux \
#%endif
#%if&#160;%{kerberos5}
#	--with-kerberos5${krb5_prefix:+=${krb5_prefix}} \
#%else
#	--without-kerberos5 \
#%endif
#%if&#160;%{libedit}
#	--with-libedit
#%else
#	--without-libedit
#%endif

%if&#160;%{static_libcrypto}
perl -pi -e &quot;s|-lcrypto|%{_libdir}/libcrypto.a|g&quot; Makefile
%endif

make

# Define a variable to toggle gnome1/gtk2 building.  This is necessary
# because RPM doesn't handle nested&#160;%if statements.
%if&#160;%{gtk2}
	gtk2=yes
%else
	gtk2=no
%endif

%if&#160;!&#160;%{no_gnome_askpass}
pushd contrib
if [ $gtk2 = yes ]&#160;; then
	make gnome-ssh-askpass2
	mv gnome-ssh-askpass2 gnome-ssh-askpass
else
	make gnome-ssh-askpass1
	mv gnome-ssh-askpass1 gnome-ssh-askpass
fi
popd
%endif

%if&#160;%{pam_ssh_agent}
pushd pam_ssh_agent_auth-%{pam_ssh_agent_ver}
LDFLAGS=&quot;$SAVE_LDFLAGS&quot;
%configure --with-selinux --libexecdir=/%{_lib}/security
make
popd
%endif

# Add generation of HMAC checksums of the final stripped binaries
%define __spec_install_post \
   &#160;%{?__debug_package:%{__debug_install_post}} \
   &#160;%{__arch_install_post} \
   &#160;%{__os_install_post} \
    fipshmac $RPM_BUILD_ROOT%{_bindir}/ssh \
    fipshmac $RPM_BUILD_ROOT%{_sbindir}/sshd \
%{nil}

%install
rm -rf $RPM_BUILD_ROOT
mkdir -p -m755 $RPM_BUILD_ROOT%{_sysconfdir}/ssh
mkdir -p -m755 $RPM_BUILD_ROOT%{_libexecdir}/openssh
mkdir -p -m755 $RPM_BUILD_ROOT%{_var}/empty/sshd
make install DESTDIR=$RPM_BUILD_ROOT
%if&#160;%{ldap}
rm -f $RPM_BUILD_ROOT%{_sysconfdir}/ssh/ldap.conf
%endif

install -d $RPM_BUILD_ROOT/etc/pam.d/
install -d $RPM_BUILD_ROOT/etc/sysconfig/
install -d $RPM_BUILD_ROOT/etc/rc.d/init.d
install -d $RPM_BUILD_ROOT%{_libexecdir}/openssh
install -m644&#160;%{SOURCE2} $RPM_BUILD_ROOT/etc/pam.d/sshd
install -m644&#160;%{SOURCE6} $RPM_BUILD_ROOT/etc/pam.d/ssh-keycat
install -m755&#160;%{SOURCE3} $RPM_BUILD_ROOT/etc/rc.d/init.d/sshd
install -m644&#160;%{SOURCE7} $RPM_BUILD_ROOT/etc/sysconfig/sshd
install -m755 contrib/ssh-copy-id $RPM_BUILD_ROOT%{_bindir}/
install contrib/ssh-copy-id.1 $RPM_BUILD_ROOT%{_mandir}/man1/

%if&#160;!&#160;%{no_gnome_askpass}
install -s contrib/gnome-ssh-askpass $RPM_BUILD_ROOT%{_libexecdir}/openssh/gnome-ssh-askpass
%endif

%if&#160;!&#160;%{scard}
	rm -f $RPM_BUILD_ROOT%{_datadir}/openssh/Ssh.bin
%endif

%if&#160;!&#160;%{no_gnome_askpass}
ln -s gnome-ssh-askpass $RPM_BUILD_ROOT%{_libexecdir}/openssh/ssh-askpass
install -m 755 -d $RPM_BUILD_ROOT%{_sysconfdir}/profile.d/
install -m 755 contrib/redhat/gnome-ssh-askpass.csh $RPM_BUILD_ROOT%{_sysconfdir}/profile.d/
install -m 755 contrib/redhat/gnome-ssh-askpass.sh $RPM_BUILD_ROOT%{_sysconfdir}/profile.d/
%endif

%if&#160;%{no_gnome_askpass}
rm -f $RPM_BUILD_ROOT/etc/profile.d/gnome-ssh-askpass.*
%endif

perl -pi -e &quot;s|$RPM_BUILD_ROOT||g&quot; $RPM_BUILD_ROOT%{_mandir}/man*/*

rm -f README.nss.nss-keys
%if&#160;!&#160;%{nss}
rm -f README.nss
%endif

%if&#160;%{pam_ssh_agent}
pushd pam_ssh_agent_auth-%{pam_ssh_agent_ver}
make install DESTDIR=$RPM_BUILD_ROOT
popd
%endif
%clean
rm -rf $RPM_BUILD_ROOT

%pre server
getent group sshd &gt;/dev/null || groupadd -g&#160;%{sshd_uid} -r sshd ||&#160;:
%if&#160;%{nologin}
getent passwd sshd &gt;/dev/null || \
  useradd -c &quot;Privilege-separated SSH&quot; -u&#160;%{sshd_uid} -g sshd  -s /sbin/nologin \
  -s /sbin/nologin -r -d /var/empty/sshd sshd 2&gt; /dev/null ||&#160;:
%else
getent passwd sshd &gt;/dev/null || \
  useradd -c &quot;Privilege-separated SSH&quot; -u&#160;%{sshd_uid} -g sshd  -s /sbin/nologin \
  -s /dev/null -r -d /var/empty/sshd sshd 2&gt; /dev/null ||&#160;:
%endif

%post server
/sbin/chkconfig --add sshd

%postun server
/sbin/service sshd condrestart &gt; /dev/null 2&gt;&amp;1 ||&#160;:

%preun server
if [ &quot;$1&quot; = 0 ]
then
	/sbin/service sshd stop &gt; /dev/null 2&gt;&amp;1 ||&#160;:
	/sbin/chkconfig --del sshd
fi

%files
%defattr(-,root,root)
%doc CREDITS ChangeLog INSTALL LICENCE OVERVIEW PROTOCOL* README* TODO WARNING*
%attr(0755,root,root)&#160;%dir&#160;%{_sysconfdir}/ssh
%attr(0600,root,root)&#160;%config(noreplace)&#160;%{_sysconfdir}/ssh/moduli
%if&#160;!&#160;%{rescue}
%attr(0755,root,root)&#160;%{_bindir}/ssh-keygen
%attr(0644,root,root)&#160;%{_mandir}/man1/ssh-keygen.1*
%attr(0755,root,root)&#160;%dir&#160;%{_libexecdir}/openssh
%attr(4755,root,root)&#160;%{_libexecdir}/openssh/ssh-keysign
%attr(0644,root,root)&#160;%{_mandir}/man8/ssh-keysign.8*
%endif
%if&#160;%{scard}
%attr(0755,root,root)&#160;%dir&#160;%{_datadir}/openssh
%attr(0644,root,root)&#160;%{_datadir}/openssh/Ssh.bin
%endif

%files clients
%defattr(-,root,root)
%attr(0755,root,root)&#160;%{_bindir}/ssh
%attr(0644,root,root)&#160;%{_bindir}/.ssh.hmac
%attr(0644,root,root)&#160;%{_mandir}/man1/ssh.1*
%attr(0755,root,root)&#160;%{_bindir}/scp
%attr(0644,root,root)&#160;%{_mandir}/man1/scp.1*
%attr(0644,root,root)&#160;%config(noreplace)&#160;%{_sysconfdir}/ssh/ssh_config
%attr(0755,root,root)&#160;%{_bindir}/slogin
%attr(0644,root,root)&#160;%{_mandir}/man1/slogin.1*
%attr(0644,root,root)&#160;%{_mandir}/man5/ssh_config.5*
%if&#160;!&#160;%{rescue}
%attr(2755,root,nobody)&#160;%{_bindir}/ssh-agent
%attr(0755,root,root)&#160;%{_bindir}/ssh-add
%attr(0755,root,root)&#160;%{_bindir}/ssh-keyscan
%attr(0755,root,root)&#160;%{_bindir}/sftp
%attr(0755,root,root)&#160;%{_bindir}/ssh-copy-id
%attr(0644,root,root)&#160;%{_mandir}/man1/ssh-agent.1*
%attr(0644,root,root)&#160;%{_mandir}/man1/ssh-add.1*
%attr(0644,root,root)&#160;%{_mandir}/man1/ssh-keyscan.1*
%attr(0644,root,root)&#160;%{_mandir}/man1/sftp.1*
%attr(0644,root,root)&#160;%{_mandir}/man1/ssh-copy-id.1*
%endif

%if&#160;!&#160;%{rescue}
%files server
%defattr(-,root,root)
%dir&#160;%attr(0711,root,root)&#160;%{_var}/empty/sshd
#%doc HOWTO.ssh-keycat
%attr(0755,root,root)&#160;%{_sbindir}/sshd
%attr(0644,root,root)&#160;%{_sbindir}/.sshd.hmac
%attr(0755,root,root)&#160;%{_libexecdir}/openssh/sftp-server
%attr(0644,root,root)&#160;%{_mandir}/man5/sshd_config.5*
%attr(0644,root,root)&#160;%{_mandir}/man5/moduli.5*
%attr(0644,root,root)&#160;%{_mandir}/man8/sshd.8*
%attr(0644,root,root)&#160;%{_mandir}/man8/sftp-server.8*
%attr(0600,root,root)&#160;%config(noreplace)&#160;%{_sysconfdir}/ssh/sshd_config
%attr(0644,root,root)&#160;%config(noreplace) /etc/pam.d/sshd
%attr(0640,root,root)&#160;%config(noreplace) /etc/sysconfig/sshd
%attr(0755,root,root) /etc/rc.d/init.d/sshd
#%attr(0755,root,root)&#160;%{_libexecdir}/openssh/ssh-keycat
%attr(0644,root,root)&#160;%config(noreplace) /etc/pam.d/ssh-keycat
%endif

#%if&#160;%{ldap}
#%files ldap
#%defattr(-,root,root)
#%doc HOWTO.ldap-keys openssh-lpk-openldap.schema openssh-lpk-sun.schema ldap.conf
#%attr(0755,root,root)&#160;%{_libexecdir}/openssh/ssh-ldap-helper
#%attr(0755,root,root)&#160;%{_libexecdir}/openssh/ssh-ldap-wrapper
#%attr(0644,root,root)&#160;%{_mandir}/man8/ssh-ldap-helper.8*
#%attr(0644,root,root)&#160;%{_mandir}/man5/ssh-ldap.conf.5*
#%endif


%if&#160;!&#160;%{no_gnome_askpass}
%files askpass
%defattr(-,root,root)
%attr(0644,root,root)&#160;%{_sysconfdir}/profile.d/gnome-ssh-askpass.*
%attr(0755,root,root)&#160;%{_libexecdir}/openssh/gnome-ssh-askpass
%attr(0755,root,root)&#160;%{_libexecdir}/openssh/ssh-askpass
%endif

%if&#160;%{pam_ssh_agent}
%files -n pam_ssh_agent_auth
%defattr(-,root,root)
%doc pam_ssh_agent_auth-%{pam_ssh_agent_ver}/GPL_LICENSE
%doc pam_ssh_agent_auth-%{pam_ssh_agent_ver}/OPENSSH_LICENSE
%doc pam_ssh_agent_auth-%{pam_ssh_agent_ver}/LICENSE.OpenSSL
%attr(0755,root,root) /%{_lib}/security/pam_ssh_agent_auth.so
%attr(0644,root,root)&#160;%{_mandir}/man8/pam_ssh_agent_auth.8*
%endif

%changelog
* Mon May 30 2011 Jan F. Chadima &lt;jchadima@redhat.com&gt; - 5.5p1-52.2
- improove reseed (#708924)
</pre>

<!-- 
NewPP limit report
Preprocessor node count: 4/1000000
Post-expand include size: 0/2097152 bytes
Template argument size: 0/2097152 bytes
Expensive parser function count: 0/100
-->

<!-- Saved in parser cache with key my_wiki:pcache:idhash:485-0!*!*!*!*!*!* and timestamp 20130920110805 -->
</div>				<!-- /bodycontent -->
								<!-- printfooter -->
				<div class="printfooter">
				Retrieved from "<a href="http://wiki.xkyle.com/index.php?title=HPN-SSH_on_RHEL6&amp;oldid=1672">http://wiki.xkyle.com/index.php?title=HPN-SSH_on_RHEL6&amp;oldid=1672</a>"				</div>
				<!-- /printfooter -->
												<!-- catlinks -->
				<div id='catlinks' class='catlinks'><div id="mw-normal-catlinks" class="mw-normal-catlinks"><a href="/Special:Categories.html" title="Special:Categories">Categories</a>: <ul><li><a href="/Category:SSH.html" title="Category:SSH">SSH</a></li><li><a href="/index.php?title=Category:RHEL6&amp;action=edit&amp;redlink=1" class="new" title="Category:RHEL6 (page does not exist)">RHEL6</a></li><li><a href="/Category:HPC.html" title="Category:HPC">HPC</a></li></ul></div></div>				<!-- /catlinks -->
												<div class="visualClear"></div>
				<!-- debughtml -->
								<!-- /debughtml -->
			</div>
			<!-- /bodyContent -->
		</div>
		<!-- /content -->
		<!-- header -->
		<div id="mw-head" class="noprint">
			
<!-- 0 -->
<div id="p-personal" class="">
	<h5>Personal tools</h5>
	<ul>
		<li id="pt-login"><a href="/index.php?title=Special:UserLogin&amp;returnto=HPN-SSH+on+RHEL6" title="You are encouraged to log in; however, it is not mandatory [o]" accesskey="o">Log in</a></li>
	</ul>
</div>

<!-- /0 -->
			<div id="left-navigation">
				
<!-- 0 -->
<div id="p-namespaces" class="vectorTabs">
	<h5>Namespaces</h5>
	<ul>
					<li  id="ca-nstab-main" class="selected"><span><a href="/HPN-SSH_on_RHEL6.html"  title="View the content page [c]" accesskey="c">Page</a></span></li>
					<li  id="ca-talk" class="new"><span><a href="/index.php?title=Talk:HPN-SSH_on_RHEL6&amp;action=edit&amp;redlink=1"  title="Discussion about the content page [t]" accesskey="t">Discussion</a></span></li>
			</ul>
</div>

<!-- /0 -->

<!-- 1 -->
<div id="p-variants" class="vectorMenu emptyPortlet">
	<h4>
		</h4>
	<h5><span>Variants</span><a href="#"></a></h5>
	<div class="menu">
		<ul>
					</ul>
	</div>
</div>

<!-- /1 -->
			</div>
			<div id="right-navigation">
				
<!-- 0 -->
<div id="p-views" class="vectorTabs">
	<h5>Views</h5>
	<ul>
					<li id="ca-view" class="selected"><span><a href="/HPN-SSH_on_RHEL6.html" >Read</a></span></li>
					<li id="ca-viewsource"><span><a href="/index.php?title=HPN-SSH_on_RHEL6&amp;action=edit"  title="This page is protected.&#10;You can view its source [e]" accesskey="e">View source</a></span></li>
					<li id="ca-history" class="collapsible"><span><a href="/index.php?title=HPN-SSH_on_RHEL6&amp;action=history"  title="Past revisions of this page [h]" accesskey="h">View history</a></span></li>
			</ul>
</div>

<!-- /0 -->

<!-- 1 -->
<div id="p-cactions" class="vectorMenu emptyPortlet">
	<h5><span>Actions</span><a href="#"></a></h5>
	<div class="menu">
		<ul>
					</ul>
	</div>
</div>

<!-- /1 -->

<!-- 2 -->
<div id="p-search">
	<h5><label for="searchInput">Search</label></h5>
	<form action="/index.php" id="searchform">
				<div>
			<input type="search" name="search" title="Search Kyle's Wiki [f]" accesskey="f" id="searchInput" />			<input type="submit" name="go" value="Go" title="Go to a page with this exact name if exists" id="searchGoButton" class="searchButton" />			<input type="submit" name="fulltext" value="Search" title="Search the pages for this text" id="mw-searchButton" class="searchButton" />					<input type='hidden' name="title" value="Special:Search"/>
		</div>
	</form>
</div>

<!-- /2 -->
			</div>
		</div>
		<!-- /header -->
		<!-- panel -->
			<div id="mw-panel" class="noprint">
				<!-- logo -->
					<div id="p-logo"><a style="background-image: url(http://wiki.xkyle.com/images/logo.jpg);" href="/Main_Page"  title="Visit the main page"></a></div>
				<!-- /logo -->
				
<!-- Efforts -->
<div class="portal" id='p-Efforts'>
	<h5>Efforts</h5>
	<div class="body">
		<ul>
			<li id="n-Plug-Computers"><a href="/Plug_Computers.html">Plug Computers</a></li>
			<li id="n-Hack-This-Site"><a href="/Hack_This_Site.html">Hack This Site</a></li>
			<li id="n-Games-Magazine"><a href="/Games_Magazine.html">Games Magazine</a></li>
			<li id="n-CFEngine"><a href="/Category:CFEngine.html">CFEngine</a></li>
			<li id="n-Puppet"><a href="/Category:Puppet.html">Puppet</a></li>
			<li id="n-BackupPC"><a href="/Category:BackupPC.html">BackupPC</a></li>
			<li id="n-IPv6"><a href="/Category:IPv6.html">IPv6</a></li>
		</ul>
	</div>
</div>

<!-- /Efforts -->

<!-- SEARCH -->

<!-- /SEARCH -->

<!-- TOOLBOX -->
<div class="portal" id='p-tb'>
	<h5>Toolbox</h5>
	<div class="body">
		<ul>
			<li id="t-whatlinkshere"><a href="/Special:WhatLinksHere/HPN-SSH_on_RHEL6" title="A list of all wiki pages that link here [j]" accesskey="j">What links here</a></li>
			<li id="t-recentchangeslinked"><a href="/Special:RecentChangesLinked/HPN-SSH_on_RHEL6" title="Recent changes in pages linked from this page [k]" accesskey="k">Related changes</a></li>
			<li id="t-specialpages"><a href="/Special:SpecialPages.html" title="A list of all special pages [q]" accesskey="q">Special pages</a></li>
			<li><a href="/index.php?title=HPN-SSH_on_RHEL6&amp;printable=yes" rel="alternate">Printable version</a></li>
			<li id="t-permalink"><a href="/index.php?title=HPN-SSH_on_RHEL6&amp;oldid=1672" title="Permanent link to this revision of the page">Permanent link</a></li>
		</ul>
	</div>
</div>

<!-- /TOOLBOX -->

<!-- LANGUAGES -->

<!-- /LANGUAGES -->
                                <div class="portal" id='p-Meta'>

                                <h5>Meta</h5>
                                <div class="body">
                                        <ul>
                                                <li id="n-About-this-Wiki"><a href="/About.html">About this Wiki</a></li>
                                                <li id="n-Email-Me"><a href="mailto:kyle@xkyle.com">Email Me</a></li>
                                                <li id="n-Blog"><a href="https://xkyle.com/">My Blog</a></li>
                                                <li id="n-Code"><a href="https://github.com/solarkennedy">Code (github)</a></li>
                                                <li id="n-LinkedIn"><a href="http://www.linkedin.com/pub/kyle-anderson/6/671/2b0">LinkedIn</a></li>
                                                <li id="n-Google+"><a href="https://plus.google.com/u/0/115227890884261811459" rel="author">Google+</a><li>
                                        </ul>
                                </div>
                                </div>

			</div>
		<!-- /panel -->
		<!-- footer -->
                <div id="footer">
                        <div style="clear:both"></div>
                </div>

		<!-- /footer -->
		<script src="http://wiki.xkyle.com/load.php?debug=false&amp;lang=en&amp;modules=skins.vector&amp;only=scripts&amp;skin=vector&amp;*"></script>
<script>if(window.mw){
mw.loader.load(["mediawiki.user","mediawiki.page.ready"], null, true);
}</script>
<!-- Served in 0.205 secs. -->
	</body>
<!-- Cached/compressed 20130920110805 -->
</html>
